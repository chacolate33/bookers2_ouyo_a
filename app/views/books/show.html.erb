<div class="container">
  <div class="row">
     <%= render 'books/info', book: @book, user: @user %>

   <div class="col-md-8 offset-md-1">
   <h2>Book detail</h2>

   <table class="table">
    <tbody>
     <tr>
      <td>
       <%= link_to user_path(@show_book.user.id) do %>
        <%= attachment_image_tag @show_book.user, :profile_image, format: 'jpeg', fallback: "no_image.jpg", size: "40x40" %>
        <br>
        <%= @show_book.user.name %>
       <% end %>
      </td>
      <td>
       <%= link_to @show_book.title, book_path(@show_book.id) %>
       </td>
      <td>
        <%= @show_book.body %>
      </td>

      <td>
        <%= render 'favorites/favorites', book: @show_book%>
      </td>

      <% if @show_book.user.id == current_user.id %>
      <td>
        <%= link_to edit_book_path(@show_book.id) do %>
        <span class="btn btn-sm btn-success">Edit</span>
        <% end %>
      </td>

      <td>
        <%= link_to book_path(@show_book.id) ,method: :delete, "data-confirm" => "本当に消しますか？" do %>
        <span class="btn btn-sm btn-danger">Destroy</span>
        <% end %>
      </td>
      <% end %>

      <td>
       <p>コメント数: <%= @show_book.book_comments.count %></p>
      </td>
     </tr>
    </tbody>
   </table>

     <% if @show_book.book_comments.count != 0 %>
       <% @show_book.book_comments.each do |book_comment| %>
       
        <div class="flex">
       
         <%= link_to user_path(@show_book.user.id) do %>
         <%= attachment_image_tag @show_book.user, :profile_image, format: 'jpeg', fallback: "no_image.jpg", size: "100x100" %>
         <div><%= @show_book.user.name %></div>
         <% end %>
         
         <div class="mt-4 ml-2">
         <%= book_comment.comment %>
         
         <%= link_to book_book_comment_path(book_comment.book, book_comment), method: :delete, "data-confirm" => "本当に消しますか？" do %>
         <span class="btn btn-sm btn-danger ml-3">Destroy</span>
         <% end %>
         </div>
        </div>
        
       <% end %>
     <% end %>
         <%= form_with(model:[@show_book, @book_comment], local: true) do |f| %>
           <%= f.text_area :comment, rows:'5', class: 'w-100' %><br>
           <%= f.submit "送信" %>
         <% end %>
   </div>
  </div>
  </div>
</div>